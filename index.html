<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>å¦³çš„å°å°å¿ƒæƒ…ç«™</title>
  <style>
    body {
      background: linear-gradient(135deg, #fce4ec, #f8bbd0);
      font-family: "å¾®è»Ÿæ­£é»‘é«”", sans-serif;
      color: #444;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    h1 {
      color: #c2185b;
      margin-bottom: 10px;
    }
    .emoji-container {
      margin: 20px 0;
    }
    button.emoji-btn {
      font-size: 48px;
      background: none;
      border: none;
      cursor: pointer;
      margin: 10px;
      transition: transform 0.2s;
    }
    button.emoji-btn:hover {
      transform: scale(1.3);
    }
    #result {
      font-size: 22px;
      margin-top: 20px;
      color: #880e4f;
      min-height: 48px;
    }
    #resetBtn {
      margin-top: 30px;
      padding: 10px 20px;
      border: none;
      background-color: #f06292;
      color: white;
      font-size: 16px;
      border-radius: 6px;
      cursor: pointer;
      display: none;
    }
    canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
    }
  </style>
</head>
<body>

<canvas id="snow"></canvas>

<h1>ä»Šå¤©å¦³çš„å¿ƒæƒ…ï¼Ÿ</h1>
<div class="emoji-container">
  <button class="emoji-btn" data-key="happy">ğŸ˜Š</button>
  <button class="emoji-btn" data-key="tired">ğŸ˜´</button>
  <button class="emoji-btn" data-key="sad">ğŸ˜¢</button>
  <button class="emoji-btn" data-key="angry">ğŸ˜ </button>
  <button class="emoji-btn" data-key="love">ğŸ˜</button>
</div>

<div id="result"></div>
<audio id="audioPlayer" controls></audio>
<button id="resetBtn">é‡æ–°é¸æ“‡å¿ƒæƒ…</button>

<script>
  const emojiButtons = document.querySelectorAll(".emoji-btn");
  const resultDiv = document.getElementById("result");
  const resetBtn = document.getElementById("resetBtn");
  const audioPlayer = document.getElementById("audioPlayer");

  // éŸ³æ¨‚æ¸…å–® (ç¯„ä¾‹ä½¿ç”¨ Google Drive ç›´éˆï¼Œè«‹æ›æˆä½ çš„)
  const musicList = [
    "day1.mp3.mp3",
    "day2.mp3.mp3",
    "day3.mp3.mp3",
    "day4.mp3.mp3",
    "day5.mp3.mp3",
    "day6.mp3.mp3",
    "day7.mp3.mp3"
  ];

  let currentMusicIndex = 0;
  audioPlayer.src = musicList[currentMusicIndex];
  audioPlayer.addEventListener("ended", () => {
    currentMusicIndex = (currentMusicIndex + 1) % musicList.length;
    audioPlayer.src = musicList[currentMusicIndex];
    audioPlayer.play();
  });

  // å¿ƒæƒ…èªéŒ„ï¼Œæ¯å€‹è‡³å°‘5å¥
  const messages = {
    happy: [
      "çœ‹åˆ°å¦³çš„ç¬‘å®¹ï¼Œä»Šå¤©çš„é™½å…‰éƒ½è®Šç”œäº†ã€‚",
      "å¦³é–‹å¿ƒçš„æ¨£å­ï¼Œæ˜¯æˆ‘æœ€å–œæ­¡çš„ç•«é¢ã€‚",
      "å¸Œæœ›ä»Šå¤©çš„å¿«æ¨‚ï¼Œèƒ½åœç•™ä¹…ä¸€é»ã€‚",
      "æœ‰å¦³é–‹å¿ƒçš„æ¶ˆæ¯ï¼Œæˆ‘ä¹Ÿè·Ÿè‘—å¿ƒæƒ…å¥½ã€‚",
      "æ„Ÿè¬å¦³ä»Šå¤©çš„ç¬‘ï¼Œè®“ä¸–ç•Œå¤šäº†ä»½æº«æš–ã€‚"
    ],
    tired: [
      "å¦³ç´¯äº†å—ï¼Ÿå¦‚æœå¯ä»¥ï¼Œæˆ‘æƒ³æˆç‚ºè®“å¦³æ”¾é¬†çš„äººã€‚",
      "æƒ³å·å·ç‚ºå¦³æ‰“æ°£ï¼Œæ’éä»Šå¤©ï¼Œæ™šé»å¥½å¥½ä¼‘æ¯å§ã€‚",
      "å†å¤šè¾›è‹¦ï¼Œå¦³ä¹Ÿé‚„æ˜¯æˆ‘å¿ƒä¸­æœ€ç¾çš„äººã€‚",
      "ä¸ç®¡æœ‰å¤šå¿™ï¼Œè«‹è¨˜å¾—å–˜å£æ°£ã€‚",
      "ç´¯äº†å°±åœä¸€ä¸‹ï¼Œåˆ¥ç‚ºäº†åˆ¥äººå¿˜äº†è‡ªå·±ã€‚"
    ],
    sad: [
      "æƒ³æˆç‚ºé‚£å€‹ï¼Œè®“å¦³é ä¸€ä¸‹çš„äººã€‚",
      "å¦³å¯ä»¥é›£éï¼Œæ²’é—œä¿‚ï¼Œæˆ‘ä¸æœƒèµ°é–‹ã€‚",
      "å¦‚æœå¦³æƒ³ï¼Œæˆ‘å¯ä»¥å®‰éœåœ°é™ªè‘—å¦³ã€‚",
      "ä»Šå¤©çš„æ·šæ°´ï¼Œè®“æˆ‘å·å·å¹«å¦³æ“¦æ‰å¥½å—ï¼Ÿ",
      "é¡˜æˆ‘å¯ä»¥è®“å¦³çš„é›£éï¼Œå°‘ä¸€é»é»ã€‚"
    ],
    angry: [
      "å¦³çš„æƒ…ç·’ï¼Œæˆ‘æƒ³æ¥ä½ï¼Œä¸æƒ³å¦³æ‚¶åœ¨å¿ƒè£¡ã€‚",
      "ä¸ç®¡å¦³æœ‰å¤šæ°£ï¼Œå¦³é‚„æ˜¯é‚£å€‹æˆ‘åœ¨ä¹çš„äººã€‚",
      "ç­‰å¦³æ°£æ¶ˆï¼Œæˆ‘æƒ³ç´„å¦³åƒå¦³æœ€æ„›çš„ç”œé£Ÿã€‚",
      "å¶çˆ¾ç”Ÿæ°£ä¹Ÿæ˜¯å¦³å¯æ„›çš„è¡¨æƒ…ä¹‹ä¸€ã€‚",
      "å¦‚æœå¯ä»¥ï¼Œæˆ‘æƒ³è½å¦³æŠŠä¸æ»¿å…¨è¬›å‡ºä¾†ã€‚"
    ],
    love: [
      "ä¸æƒ³å¤šèªªä»€éº¼å¤§é“ç†ï¼Œåªæƒ³å‘Šè¨´å¦³ï¼Œä»Šå¤©ä¹Ÿæƒ³å¦³ã€‚",
      "æœ‰å¦³åœ¨çš„ç•«é¢ï¼Œå°±è¶³å¤ è®“æˆ‘å¿ƒå‹•ã€‚",
      "æ¯æ¬¡æƒ³åˆ°å¦³ï¼Œå˜´è§’ç¸½æ˜¯ä¸è‡ªè¦ºä¸Šæšã€‚",
      "è¬è¬å¦³å‡ºç¾åœ¨æˆ‘ç”Ÿå‘½è£¡ï¼Œè®“æˆ‘çš„ä¸–ç•Œæ›´æº«æš–ã€‚",
      "ä»Šå¤©ï¼Œä¹Ÿæ˜¯æƒ³å°å¦³èªªï¼šå¥½å–œæ­¡å¦³ã€‚"
    ]
  };

  const usedMessages = {
    happy: [],
    tired: [],
    sad: [],
    angry: [],
    love: []
  };

  function getTodayKey() {
    const d = new Date();
    return d.toISOString().slice(0,10);
  }

  function checkTodayMood() {
    const today = getTodayKey();
    return localStorage.getItem("mood_" + today);
  }

  function getRandomMessage(key) {
    const pool = messages[key];
    const used = usedMessages[key];

    if (used.length >= pool.length) {
      usedMessages[key] = []; // å…¨éƒ¨ç”¨éä¸€æ¬¡å¾Œé‡ç½®
    }

    let available = pool.filter(msg => !used.includes(msg));
    let selected = available[Math.floor(Math.random() * available.length)];
    usedMessages[key].push(selected);
    return selected;
  }

  function showResult(key) {
    if (key && messages[key]) {
      const msg = getRandomMessage(key);
      resultDiv.textContent = msg;
      audioPlayer.play();
      resetBtn.style.display = "inline-block";
    }
  }

  function setMood(key) {
    const today = getTodayKey();
    localStorage.setItem("mood_" + today, key);
    showResult(key);
    emojiButtons.forEach(b => b.disabled = true);
  }

  function init() {
    const todayMood = checkTodayMood();
    if (todayMood) {
      showResult(todayMood);
      emojiButtons.forEach(btn => btn.disabled = true);
    } else {
      emojiButtons.forEach(btn => btn.disabled = false);
      resultDiv.textContent = "";
      resetBtn.style.display = "none";
    }
  }

  emojiButtons.forEach(btn => {
    btn.addEventListener("click", () => {
      const key = btn.getAttribute("data-key");
      setMood(key);
    });
  });

  resetBtn.addEventListener("click", () => {
    const today = getTodayKey();
    localStorage.removeItem("mood_" + today);
    init();
  });

  init();

  // é›ªèŠ±å‹•ç•«
  const canvas = document.getElementById('snow');
  const ctx = canvas.getContext('2d');
  let width, height;
  let snowflakes = [];

  function initSnow() {
    width = window.innerWidth;
    height = window.innerHeight;
    canvas.width = width;
    canvas.height = height;
    snowflakes = [];
    for (let i = 0; i < 100; i++) {
      snowflakes.push({
        x: Math.random() * width,
        y: Math.random() * height,
        r: Math.random() * 4 + 1,
        d: Math.random() * 1 + 0.5
      });
    }
  }

  function drawSnow() {
    ctx.clearRect(0, 0, width, height);
    ctx.fillStyle = "white";
    ctx.beginPath();
    snowflakes.forEach(flake => {
      ctx.moveTo(flake.x, flake.y);
      ctx.arc(flake.x, flake.y, flake.r, 0, Math.PI * 2);
    });
    ctx.fill();
    moveSnow();
  }

  function moveSnow() {
    snowflakes.forEach(flake => {
      flake.y += flake.d;
      flake.x += Math.sin(flake.y * 0.01);
      if (flake.y > height) {
        flake.y = -flake.r;
        flake.x = Math.random() * width;
      }
    });
  }

  window.addEventListener('resize', initSnow);
  initSnow();
  setInterval(drawSnow, 33);
</script>

</body>
</html>
